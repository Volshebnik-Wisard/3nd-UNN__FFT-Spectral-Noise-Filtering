# Фильтрация сигнала от шума на основе преобразования Фурье

### Цель учебной задачи
Целью данной задачи является применение алгоритма быстрого преобразования Фурье для анализа и обработки экспериментальных данных, в частности, при решении одной из важных задач цифровой обработки, связанной с фильтрацией зашумленных сигналов в частотной области. Если ограничиться дискретными последовательностями данных, длина которых является степенью двух, то может быть применён алгоритм так называемого быстрого преобразования Фурье (БПФ), который имеет значительно меньшую вычислительную сложность по сравнению с прямым вычислением дискретного преобразования Фурье. Выполнение фильтрации сигналов основано на различии спектральных характеристик сигналов и шумов, что необходимо учитывать при моделировании зашумленных сигналов.

## Постановка задачи

В данной задаче требуется реализовать метод фильтрации в частотной области зашумленного сигнала с использованием алгоритма быстрого преобразования Фурье. В качестве полезного сигнала предлагается использовать полигармонический сигнал, который представляет собой сумму синусоид с разными амплитудами и частотами:

$$
x[n] = \sum_{i=1}^M A_i \cdot sin(2πf_inT + φ_i),
$$

где $f_i$, $A_i$, $φ_i$ – частота, амплитуда и начальная фаза i-ой гармоники, соответственно. $M$ – число гармоник, в данной задаче $M = (1...3)$. Поскольку Фурье-фильтрация предполагает различие частотных характеристик полезного сигнала и шума, предполагается, что сигнал является низкочастотным. Для простоты реализации период дискретизации полагаем равной единице: $T = 1$. 

Далее к исходному сигналу необходимо добавить белый гауссов шум так, чтобы полученный зашумлённый сигнал характеризовался заданным отношением сигнал/шум (ОСШ). Для простоты в данной задаче уровень шума можно задавать как процентную долю энергии реализации шума по отношению к энергии реализации исходного сигнала. Для этого требуется сгенерировать последовательность нормально распределённых случайных чисел, например в интервале значений $[−1, 1]$. 

Поскольку шум в данной задаче является аддитивным, он накладывается на исходный сигнал простым сложением:

$$
x̃_i = x_i + ξ_i, 
$$

где $x̃_i$ – отсчёты зашумлённого сигнала, $x_i$ – отсчёты исходного сигнала, а $ξ_i$ – отсчёты отнормированной шумовой последовательности.

Поскольку белый шум является некоррелированным с сигналом случайным процессом и занимает всю полосу частот, а полезный сигнал является низкочастотным, это позволяет достаточно эффективно очистить исходный полигармонический сигнал от шума в частотной области. Чтобы перейти в частотную область, необходимо выполнить преобразование Фурье зашумлённого сигнала, для чего его нужно преобразовать в комплексный сигнал, добавив нулевую мнимую часть. Полученный график будет содержать спектральные отсчёты сигнала от нуля до частоты дискретизации, первая половина массива $[0, N/2 − 1]$ соответствует положительным частотам, другая половина массива $[N/2, N − 1]$ соответствует отрицательным частотам, расположенным симметрично по отношению к положительным частотам относительно центра массива. При этом все операции, связанные с фильтрацией в частотной области, необходимо выполнять над комплексным спектром. 

Алгоритм фильтрации низкочастотного сигнала состоит в следующем. Задается значение коэффициента (порога), определяющего долю энергии спектра сигнала, которая сохраняется в результате проведения фильтрации. Вычисляется полная энергия спектра зашумлённого сигнала. Далее с обоих концов массива суммируется энергия спектра до достижения заданного порога. По достижении порога все остальные отсчёты комплексного спектра зануляются. Идея заключается в том, чтобы сохранить частотную область, соответствующую спектральным составляющим исходного сигнала и отбросить шумовую составляющую между спектральными пиками. 

Заключительным этапом осталось вычислить обратное преобразование Фурье от полученного «очищенного» комплексного спектра и сравнить полученный сигнал во временной области с исходным сигналом. 

## **Среда разработки**
- Visual Studio 2022 с компонентами:
  - "Разработка классических приложений на C++"
  - "Пакет SDK для Windows 10/11"
  - "MSVC версии 141 - средства сборки C++"
  - "MSVC версии 141 - библиотеки C++"

## Результат работы программы
### Сигнал и спектр сигнала:
![1](https://github.com/user-attachments/assets/763748d5-4a9b-456a-a127-338e5e2a3a60)

### Фильтрация и восстановленный сигнал:
![2](https://github.com/user-attachments/assets/a2e52059-c86b-42ad-9ba3-e8a8a57ffe55)


## Литература
- М.А. Кройц, О.А. Морозов - Методы фильтрации и линейного предсказания в цифровой обработке сигналов
